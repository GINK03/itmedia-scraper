　MVNOのSIMを利用する場合、自分のスマートフォンで本当に利用できるのかを確認することが重要だ。過去、iOSのアップデートでMVNOのSIMが使えなくなった際には、MVNOが公開する対応情報が非常に注目された。「IIJmio」を展開するインターネットイニシアティブ（IIJ）もSIMフリー端末の動作確認に注力しており、新しい端末が発売されたときや、端末のOSがアップデーとされた場合に動作を検証し、その結果を「動作確認済み端末一覧」に掲載、更新している。 　1月23日に都内で開催された「IIJmio meeting 10」では、SIMロックフリー端末の動作をどのように検証しているのか、検証によってどんなことが分かるのかについて、コンシューマサービス部 サービス企画課の松崎考視氏とIIJのエンジニア 大内宗徳氏が紹介した。 　IIJで行っている端末の検証には、「ブラックボックステスト」と「詳細調査」の2タイプがある。ブラックボックステストとは、端末の内部構造は問題にせず、外部から見える機能を検証するというテスト方法で、こちらは松崎氏が担当。その検証の結果、端末の挙動に問題がある場合は、大内氏のチームが詳細に調査する。 　iPhone、iPad、Nexusシリーズ、「IIJmioサプライサービス」取り扱い端末は購入しているが、それ以外の大半の端末は、さまざまな経路を頼って借りている。社内で募ることもあれば、パートナー店舗の携帯電話コーナーで検証することもある。動作確認済み端末のページに掲載してほしいということで、端末を提供してくれるメーカーも増えているそうだ。 　検証するのは、「LTE対応」「SIMサイズ」「テザリング」「アンテナピクト」「IPv6」など11項目。松崎氏によると「自分がやっている検証の内容は非常にシンプル。ユーザーが見て確認するのと同じレベルで、テストして期待通りの結果が返ってくるかをチェックするのみ」だそうだが、これらの検証は松崎氏1人で行っているということで、端末台数が多い場合は大変だ。 　例えばLTE対応の確認は、IIJmioのSIMを差し、電源を入れてLTEのピクトが立つかどうかをチェックする。3Gと表示している場合は、IIJの3G専用設備に収容されているのか、それともLTEに収容されているものの、エリアの関係でたまたま3Gになっているのかを確認する。 　IPv6が使えるかどうかは、検証端末のAPNをIPv6が使える設定にして、接続ログがIPv6のIPアドレスであるかを確認する。テザリングは、検証端末でテザリングをオンにして別の端末を接続し、そこからネット接続できるかをチェックする。 　音声通話の確認の場合もみおふぉんのSIMカードを差し、ちゃんと発信・着信ができるかどうかを見る。ドコモのSIMの場合「111」に発信して発信をチェックするが、電話を切るとコールバックされるという機能があるため便利だそうだ。通話料が安くなる「みおふぉんダイアル」のチェックには2台の端末を使用。プレフィックス番号を付けて発信し、相手側に着信できるか、電話番号がきちんと通知されるかを確認する。 　VoLTE対応端末の場合は、音声通話中であっても、データ通信ピクトが3Gに落ちず、LTEのまま通話ができているかを確認する。高音質通話を確認する場合は、もう1台VoLTE対応端末を用意し、通話の最中にHDのアイコンが付くかどうかを確認するという。 　検証して挙動がおかしいときには重点的にチェックし、どうしてもおかしいという場合には大内氏が担当する検証チームで、より詳細に調べることになる。検証中に分かった各端末の癖や気をつけた方がいいポイントはメモして、検証情報を更新する際に備考に掲載している。 　新しいiPhoneが発売されるときやiOSのバージョンアップ時は、ユーザーからの注目度も非常に高い。iOSのメジャーバージョンアップは日本時間の午前2時から始まることが多いので、それに合わせて会社に待機。検証用のiOS端末をすべてバージョンアップする。しかし、全世界で同時にアップデートが始まるため、混雑してアップデートに失敗することもある。それを何度もリトライし、アップデートを完了させることが最も大変な作業だ。全てアップデートしたら動作検証し、Webを更新してツイートで通知する。全ての作業が終わるのは、午前5時くらいになるそうだ。 　iPhoneの新モデルが発売されるときは、もちろん予約。販売初日に購入して近くの喫茶店などで検証し、すぐにWebページを更新する。iPhoneやiOSの場合は多くの反響があるため、なるべく早く結果を公表できるように「速度を重要視して頑張っている」（松崎氏）とのことだ。 　こうした検証でさまざまな問題が発覚した。iOS 7の際は、データ通信SIMでiPhone 4やiPad 2が通信できなくなり、iOS 8.xではデータSIMで、iPad 4とiPad miniでLTE通信ができなくなった。このときは大内氏の検証チームでより詳しいチェックを行い、その結果を過去のIIJmio meetingなどで発表している。最近でも、iOS 9で古いバージョンの構成プロファイルが使えなくなるということもあったが、IIJから新しい構成プロファイルがいち早く提供されている。 　なお、Android 4.3（Jelly Beans）でIIJmioのAPNが初めてリストに加わり、SIMを差して電源を入れるだけで自動的に接続できるようになったことが、松崎氏にとっては感動した思い出だそうだ。しかし、Android 5.0（Lolipop）ではこれがアダになり、APNサーチでデータ通信接続が不安定になったことがあった。この際も大内チームが検証し、自分が使う以外のAPN設定を削除すると安定するという対処法を提案している。 　過去、IIJの検証でiPhoneやAndroid端末の不思議な挙動が解明されてきた。松崎氏は、動作を完全に保証しているものではないと前置きしつつ、「実際に詳しく検証しているので、われわれのリストに載っている端末は安心して手にとっていただきたい」と語った。 　松崎氏の検証で端末に問題が見つかった場合は、大内氏のチームが、原因や回避策を調査するために詳細調査を行う。 　この調査では、端末内部のファイルや設定値の解析、ソースコード解析、外部とのデータ通信解析、モバイルの制御信号解析を行っている。 　内部のファイルや設定値の解析では、端末内のログファイルや設定ファイル、設定値を調査。これらの設定の意味は公表されているものが少ないので、Web検索で調べたり推測したりする。ソースコードの解析では端末の通信に関わる実装を直接確認するが、これができるのはソースコードが公開されているAndroid端末のみだ。「Android Open Source Project」で公開されているソースコードを確認したり、チップベンダーの実装に関して、Webで見つかる情報を調査したりする。 　外部とのデータ通信解析は、SSL化を解除して中身を確認する。例えばiOS端末がAppleのサーバと通信している情報も、ツールを使って確認できるそうだ。 　モバイルの制御信号解析は、モバイルデータ通信が安定して利用できないときに行う調査だ。端末と基地局間のモバイル制御情報を調べて、その挙動を解析する。実はできる端末は限られており、端末がQualcommのチップを利用し、かつ制御情報を抜き出せるデバックモードを持っている場合のみだという。 　検証ツールは、一部を除きほとんどフリーソフトだという。Android SDKのほか、「plutil.pl」という、iOSのキャリア設定ファイルをテキストベースに変換できるツールや、特権がないと見えない端末内部情報を見られるようにするツールを使うこともある。また、情報の意味はWebで検索して確認する。 　モバイルの制御信号解析では、Meritech社の「Sigma-ML/LA/PA」という商用ツールを用いて、取得したデータを可視化している。 　こうした詳細調査を行ったことで、MVNOのSIMでGPSが動作しない場合があることや、データ通信が不安定になることがあることが分かった。MVNOでGPSが動作しないという情報がSNSなどで流れたため、大内氏が調査してまとめ、IIJmio meeting 5で検証結果を紹介した。データ通信の不安定問題については、IIJmio meeting 7や8で検証結果が詳しく説明されている。 基本情報から価格比較まで――格安SIMの情報はここでチェック！→「SIM LABO」 Copyright© 2017 ITmedia, Inc. All Rights Reserved. この記事が気に入ったらITmedia Mobile に「いいね！」しよう